{"version":3,"sources":["components/Card.jsx","components/CardSelection.jsx","index.js"],"names":["Card","size","point","isSelectable","isSelected","isClosed","handleClick","props","className","join","onClick","defaultProps","points","CardSelection","selectedPoint","handleCardClick","cards","map","User","this","name","React","Component","Table","estimaters","length","now","Date","toLocaleDateString","toLocaleTimeString","sort","e1","e2","reduce","acc","cur","isOpend","estimater","handleOpenButtonClick","text","createCopyText","CopyButton","Estimater","undefined","OpenButton","PlanningPoker","eventSubscribers","select","event","state","slice","find","e","setState","unselect","filter","open","return","myName","window","prompt","roomId","socket","getSetupedRoomId","io","isOend","handleSelectionCardClick","bind","search","location","substring","uuid","uuidv4","hash","history","replaceState","on","subscriber","type","eventType","emit","myEstimater","isOff","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.7a52b559.chunk.js","sourcesContent":["\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './Card.css';\n\nexport const Card = ({ size, point, isSelectable, isSelected, isClosed, handleClick, ...props }) => {\n  return (\n    <div\n      className={[\n        \"card\",\n        (\"card-\" + size),\n        (isSelectable ? \"card-selectable\" : \"\"),\n        (isSelected ? \"card-selected\" : \"\"),\n        (isClosed ? \"card-closed\" : \"\")\n      ].join(\" \")}\n      onClick={() => handleClick(point)}\n      {...props}\n    >\n      {isClosed ? \"\" : point}\n    </div>\n  );\n}\n\nCard.propTypes = {\n  /**\n   * サイズ\n   */\n  size: PropTypes.oneOf(['small', 'medium', 'large']),\n  /**\n   * ポイント数\n   */\n  point: PropTypes.number,\n  /**\n   * 選択可能かどうか?\n   */\n  isSelectable: PropTypes.bool,\n  /**\n   * 選択されているかどうか?\n   */\n  isSelected: PropTypes.bool,\n  /**\n   * 閉じてるかどうか?\n   */\n  isClosed: PropTypes.bool,\n  /**\n   * クリック時の動作。引き数: point\n   */\n  handleClick: PropTypes.func,\n};\n\nCard.defaultProps = {\n  size: \"medium\",\n  point: 0,\n  isSelectable: false,\n  isSelected: false,\n  isClosed: false,\n  handleClick: () => { },\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Card } from \"./Card\"\nimport \"./CardSelection.css\"\n\nconst points = [\"0\", \"1\", \"2\", \"3\", \"5\", \"8\", \"13\", \"21\", \"34\", \"55\", \"?\", \"∞\"];\n\nexport const CardSelection = ({ selectedPoint, handleCardClick, ...props }) => {\n  const cards = points.map((point) => {\n    const isSelected = selectedPoint === point;\n    return (\n      <Card\n        isSelectable={true}\n        isSelected={isSelected}\n        key={point}\n        point={point}\n        handleClick={handleCardClick}\n      />\n    );\n  });\n  return <div className=\"card-selection\">{cards}</div>;\n}\n\nCardSelection.propTypes = {\n  /**\n   * 選択済ポイント\n   */\n  selectedPoint: PropTypes.string,\n  /**\n   * カードクリック時の動作。引き数: point\n   */\n  handleCardClick: PropTypes.func,\n};\n\nCardSelection.defaultProps = {\n  selectedPoint: \"\",\n  handleCardClick: () => { },\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport \"./index.css\";\nimport { Card } from \"./components/Card\"\nimport { CardSelection } from \"./components/CardSelection\"\n\nclass User extends React.Component {\n  render() {\n    return <div className=\"user\">{this.props.name}</div>;\n  }\n}\n\nclass Table extends React.Component {\n  createCopyText() {\n    const estimaters = this.props.estimaters;\n    if (estimaters.length === 0) {\n      return \"empty.\";\n    }\n    const now = new Date();\n    return (\n      \"[\" +\n      now.toLocaleDateString() +\n      \" \" +\n      now.toLocaleTimeString() +\n      \"] \" +\n      estimaters.sort((e1, e2) => e1.name > e2.name ? 1 : -1).reduce(\n        (acc, cur) => (acc ? acc + \" \" : \"\") + `${cur.name}(${cur.point})`,\n        null\n      )\n    );\n  }\n  render() {\n    const isOpend = this.props.isOpend;\n    const estimaters = this.props.estimaters.map((estimater) => {\n      return (\n        <Estimater\n          key={estimater.name}\n          name={estimater.name}\n          point={estimater.point}\n          isOpend={isOpend}\n        />\n      );\n    });\n    return (\n      <div className=\"table\">\n        <div className=\"estimaters\">{estimaters}</div>\n        <OpenButton\n          isOpend={isOpend}\n          handleClick={() => this.props.handleOpenButtonClick()}\n        />\n        {isOpend && estimaters.length > 0 ? (\n          <CopyButton text={this.createCopyText()} />\n        ) : null}\n      </div>\n    );\n  }\n}\n\nclass CopyButton extends React.Component {\n  render() {\n    return (\n      <CopyToClipboard text={this.props.text}>\n        <div className=\"copy-button\">Copy</div>\n      </CopyToClipboard>\n    );\n  }\n}\n\nclass Estimater extends React.Component {\n  render() {\n    const point = this.props.isOpend ? this.props.point : undefined;\n    const className = \"estimater \" + (this.props.isOpend ? \"opend\" : \"closed\");\n    return (\n      <div className={className}>\n        <Card isSelectable={false} isClosed={!this.props.isOpend} size=\"large\" point={point} />\n        <div className=\"estimater-name\">{this.props.name}</div>\n      </div>\n    );\n  }\n}\n\nclass OpenButton extends React.Component {\n  render() {\n    const className = \"open-button\";\n    return (\n      <div className={className} onClick={() => this.props.handleClick()}>\n        {this.props.isOpend ? \"return\" : \"open\"}\n      </div>\n    );\n  }\n}\n\nclass PlanningPoker extends React.Component {\n  constructor(props) {\n    super(props);\n    let myName = undefined;\n    while (!myName) {\n      myName = window.prompt(\"your name\");\n    }\n    const socket = setupWebsocket(this.getSetupedRoomId());\n    this.state = {\n      myName: myName,\n      estimaters: [],\n      isOend: false,\n      socket: socket,\n    };\n    this.handleSelectionCardClick = this.handleSelectionCardClick.bind(this);\n    this.handleOpenButtonClick = this.handleOpenButtonClick.bind(this);\n  }\n\n  getSetupedRoomId() {\n    const search = window.location.search;\n    let roomId;\n    if (!search) {\n      const uuid = uuidv4();\n      window.location.hash = uuid;\n      window.history.replaceState(\"\", \"\", \"?\" + uuid);\n      roomId = uuid;\n    } else {\n      roomId = search.substring(1);\n    }\n    return roomId;\n  }\n  componentDidMount() {\n    this.state.socket.on(\"do event\", (event) => {\n      const subscriber = this.eventSubscribers[event.type];\n      if (subscriber) {\n        subscriber(event);\n      }\n    });\n  }\n\n  eventSubscribers = {\n    select: (event) => {\n      let estimaters = this.state.estimaters.slice();\n      let estimater = estimaters.find((e) => e.name === event.name);\n      if (!estimater) {\n        estimater = { name: event.name };\n        estimaters[estimaters.length] = estimater;\n      }\n      estimater[\"point\"] = event.point;\n      this.setState({ estimaters: estimaters });\n    },\n    unselect: (event) => {\n      const estimaters = this.state.estimaters.filter(\n        (e) => e.name !== event.name\n      );\n      this.setState({ estimaters: estimaters });\n    },\n    open: (event) => {\n      this.setState({\n        isOpend: true,\n      });\n    },\n    return: (event) => {\n      this.setState({\n        estimaters: [],\n        isOpend: false,\n      });\n    },\n  };\n\n  handleOpenButtonClick() {\n    const isOpend =\n      this.state.estimaters.length === 0 ? false : !this.state.isOpend;\n    const eventType = isOpend ? \"open\" : \"return\";\n    this.state.socket.emit(\"do event\", { type: eventType });\n  }\n\n  handleSelectionCardClick(point) {\n    const myEstimater = this.state.estimaters.find(\n      (e) => e.name === this.state.myName\n    );\n    const isOff = myEstimater && myEstimater.point === point;\n    let estimaters = this.state.estimaters.slice();\n    if (isOff) {\n      estimaters = this.state.estimaters.filter(\n        (e) => e.name !== this.state.myName\n      );\n    } else {\n      let myEstimater = estimaters.find((e) => e.name === this.state.myName);\n      if (!myEstimater) {\n        myEstimater = { name: this.state.myName };\n        estimaters[estimaters.length] = myEstimater;\n      }\n      myEstimater[\"point\"] = point;\n    }\n    const eventType = isOff ? \"unselect\" : \"select\";\n    this.state.socket.emit(\"do event\", {\n      type: eventType,\n      name: this.state.myName,\n      point: point,\n    });\n  }\n\n  render() {\n    const myEstimater = this.state.estimaters.find(\n      (e) => e.name === this.state.myName\n    );\n    return (\n      <div>\n        <h1>Planning Poker</h1>\n        <Table\n          estimaters={this.state.estimaters}\n          isOpend={this.state.isOpend}\n          handleOpenButtonClick={this.handleOpenButtonClick}\n        />\n        <User name={this.state.myName} />\n        <CardSelection\n          selectedPoint={myEstimater ? myEstimater.point : undefined}\n          handleCardClick={this.handleSelectionCardClick}\n        />\n      </div>\n    );\n  }\n}\n\nfunction setupWebsocket(roomId) {\n  return window.io(\n    \"https://simple-websocket-server.herokuapp.com/?roomId=\" + roomId\n  );\n}\n\nReactDOM.render(<PlanningPoker />, document.getElementById(\"root\"));\n"],"sourceRoot":""}