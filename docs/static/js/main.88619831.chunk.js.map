{"version":3,"sources":["index.js"],"names":["points","Card","point","this","props","className","isSelected","onClick","handleClick","React","Component","Selection","cards","map","mySelectedPoint","handleSelectionCardClick","User","name","Table","estimaters","length","now","Date","toLocaleDateString","toLocaleTimeString","sort","e1","e2","reduce","acc","cur","isOpend","estimater","Estimater","OpenButton","handleOpenButtonClick","CopyButton","text","createCopyText","undefined","PlanningPoker","eventSubscribers","select","event","state","slice","find","e","setState","unselect","filter","open","return","myName","window","prompt","roomId","socket","getSetupedRoomId","io","isOend","bind","search","location","substring","uuid","uuidv4","hash","history","replaceState","on","subscriber","type","eventType","emit","myEstimater","isOff","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.88619831.chunk.js","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport \"./index.css\";\n\nconst points = [\"0\", \"1\", \"2\", \"3\", \"5\", \"8\", \"13\", \"21\", \"34\", \"55\", \"?\", \"âˆž\"];\n\nclass Card extends React.Component {\n  render() {\n    const point = this.props.point;\n    const className = \"card\" + (this.props.isSelected ? \" selected\" : \"\");\n    return (\n      <div className={className} onClick={this.props.handleClick}>\n        {point}\n      </div>\n    );\n  }\n}\n\nclass Selection extends React.Component {\n  render() {\n    const cards = points.map((point) => {\n      const isSelected = this.props.mySelectedPoint === point;\n      return (\n        <Card\n          isSelected={isSelected}\n          key={point}\n          point={point}\n          handleClick={() => this.props.handleSelectionCardClick(point)}\n        />\n      );\n    });\n    return <div className=\"selection\">{cards}</div>;\n  }\n}\nclass User extends React.Component {\n  render() {\n    return <div className=\"user\">{this.props.name}</div>;\n  }\n}\n\nclass Table extends React.Component {\n  createCopyText() {\n    const estimaters = this.props.estimaters;\n    if (estimaters.length === 0) {\n      return \"empty.\";\n    }\n    const now = new Date();\n    return (\n      \"[\" +\n      now.toLocaleDateString() +\n      \" \" +\n      now.toLocaleTimeString() +\n      \"] \" +\n      estimaters.sort((e1, e2) => e1.name > e2.name ? 1 : -1).reduce(\n        (acc, cur) => (acc ? acc + \" \" : \"\") + `${cur.name}(${cur.point})`,\n        null\n      )\n    );\n  }\n  render() {\n    const isOpend = this.props.isOpend;\n    const estimaters = this.props.estimaters.map((estimater) => {\n      return (\n        <Estimater\n          key={estimater.name}\n          name={estimater.name}\n          point={estimater.point}\n          isOpend={isOpend}\n        />\n      );\n    });\n    return (\n      <div className=\"table\">\n        <div className=\"estimaters\">{estimaters}</div>\n        <OpenButton\n          isOpend={isOpend}\n          handleClick={() => this.props.handleOpenButtonClick()}\n        />\n        {isOpend && estimaters.length > 0 ? (\n          <CopyButton text={this.createCopyText()} />\n        ) : null}\n      </div>\n    );\n  }\n}\n\nclass CopyButton extends React.Component {\n  render() {\n    return (\n      <CopyToClipboard text={this.props.text}>\n        <div className=\"copy-button\">Copy</div>\n      </CopyToClipboard>\n    );\n  }\n}\n\nclass Estimater extends React.Component {\n  render() {\n    const point = this.props.isOpend ? this.props.point : undefined;\n    const className = \"estimater \" + (this.props.isOpend ? \"opend\" : \"closed\");\n    return (\n      <div className={className}>\n        <Card point={point} />\n        <div className=\"estimater-name\">{this.props.name}</div>\n      </div>\n    );\n  }\n}\n\nclass OpenButton extends React.Component {\n  render() {\n    const className = \"open-button\";\n    return (\n      <div className={className} onClick={() => this.props.handleClick()}>\n        {this.props.isOpend ? \"return\" : \"open\"}\n      </div>\n    );\n  }\n}\n\nclass PlanningPoker extends React.Component {\n  constructor(props) {\n    super(props);\n    let myName = undefined;\n    while (!myName) {\n      myName = window.prompt(\"your name\");\n    }\n    const socket = setupWebsocket(this.getSetupedRoomId());\n    this.state = {\n      myName: myName,\n      estimaters: [],\n      isOend: false,\n      socket: socket,\n    };\n    this.handleSelectionCardClick = this.handleSelectionCardClick.bind(this);\n    this.handleOpenButtonClick = this.handleOpenButtonClick.bind(this);\n  }\n\n  getSetupedRoomId() {\n    const search = window.location.search;\n    let roomId;\n    if (!search) {\n      const uuid = uuidv4();\n      window.location.hash = uuid;\n      window.history.replaceState(\"\", \"\", \"?\" + uuid);\n      roomId = uuid;\n    } else {\n      roomId = search.substring(1);\n    }\n    return roomId;\n  }\n  componentDidMount() {\n    this.state.socket.on(\"do event\", (event) => {\n      const subscriber = this.eventSubscribers[event.type];\n      if (subscriber) {\n        subscriber(event);\n      }\n    });\n  }\n\n  eventSubscribers = {\n    select: (event) => {\n      let estimaters = this.state.estimaters.slice();\n      let estimater = estimaters.find((e) => e.name === event.name);\n      if (!estimater) {\n        estimater = { name: event.name };\n        estimaters[estimaters.length] = estimater;\n      }\n      estimater[\"point\"] = event.point;\n      this.setState({ estimaters: estimaters });\n    },\n    unselect: (event) => {\n      const estimaters = this.state.estimaters.filter(\n        (e) => e.name !== event.name\n      );\n      this.setState({ estimaters: estimaters });\n    },\n    open: (event) => {\n      this.setState({\n        isOpend: true,\n      });\n    },\n    return: (event) => {\n      this.setState({\n        estimaters: [],\n        isOpend: false,\n      });\n    },\n  };\n\n  handleOpenButtonClick() {\n    const isOpend =\n      this.state.estimaters.length === 0 ? false : !this.state.isOpend;\n    const eventType = isOpend ? \"open\" : \"return\";\n    this.state.socket.emit(\"do event\", { type: eventType });\n  }\n\n  handleSelectionCardClick(point) {\n    const myEstimater = this.state.estimaters.find(\n      (e) => e.name === this.state.myName\n    );\n    const isOff = myEstimater && myEstimater.point === point;\n    let estimaters = this.state.estimaters.slice();\n    if (isOff) {\n      estimaters = this.state.estimaters.filter(\n        (e) => e.name !== this.state.myName\n      );\n    } else {\n      let myEstimater = estimaters.find((e) => e.name === this.state.myName);\n      if (!myEstimater) {\n        myEstimater = { name: this.state.myName };\n        estimaters[estimaters.length] = myEstimater;\n      }\n      myEstimater[\"point\"] = point;\n    }\n    const eventType = isOff ? \"unselect\" : \"select\";\n    this.state.socket.emit(\"do event\", {\n      type: eventType,\n      name: this.state.myName,\n      point: point,\n    });\n  }\n\n  render() {\n    const myEstimater = this.state.estimaters.find(\n      (e) => e.name === this.state.myName\n    );\n    return (\n      <div>\n        <h1>Planning Poker</h1>\n        <Table\n          estimaters={this.state.estimaters}\n          isOpend={this.state.isOpend}\n          handleOpenButtonClick={this.handleOpenButtonClick}\n        />\n        <User name={this.state.myName} />\n        <Selection\n          mySelectedPoint={myEstimater ? myEstimater.point : undefined}\n          handleSelectionCardClick={this.handleSelectionCardClick}\n        />\n      </div>\n    );\n  }\n}\n\nfunction setupWebsocket(roomId) {\n  return window.io(\n    \"https://simple-websocket-server.herokuapp.com/?roomId=\" + roomId\n  );\n}\n\nReactDOM.render(<PlanningPoker />, document.getElementById(\"root\"));\n"],"sourceRoot":""}